name: frr01

topology:
  nodes:
#    mon:
#       kind: linux
#       image: moni.local
#       #binds:
#       #  - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml
#       #  - ./monitoring/grafana/provisioning/datasources:/etc/grafana/provisioning/datasources
#       #  - ./monitoring/grafana/provisioning/dashboards:/var/lib/grafana/provisioning/dashboards
#       ports:
#         - "3000:3000"   # Grafana UI
#         - "9090:9090"   # Prometheus
    r101:
      kind: linux
      image: frr-854-dev
      binds:
        - r101/daemons:/etc/frr/daemons
        - r101/frr.conf:/etc/frr/frr.conf
        - r101/vtysh.conf:/etc/frr/vtysh.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    r102:
      kind: linux
      image: frr-854-dev
      binds:
        - r102/daemons:/etc/frr/daemons
        - r102/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r103:
      kind: linux
      image: frr-854-dev
      binds:
        - r103/daemons:/etc/frr/daemons
        - r103/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    cr104:
      kind: linux
      image: frr-854-dev
      binds:
        - cr104/daemons:/etc/frr/daemons
        - cr104/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    cr105:
      kind: linux
      image: frr-854-dev
      binds:
        - cr105/daemons:/etc/frr/daemons
        - cr105/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    cr106:
      kind: linux
      image: frr-854-dev
      binds:
        - cr106/daemons:/etc/frr/daemons
        - cr106/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    cr107:
      kind: linux
      image: frr-854-dev
      binds:
        - cr107/daemons:/etc/frr/daemons
        - cr107/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    cr108:
      kind: linux
      image: frr-854-dev
      binds:
        - cr108/daemons:/etc/frr/daemons
        - cr108/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    cr109:
      kind: linux
      image: frr-854-dev
      binds:
        - cr109/daemons:/etc/frr/daemons
        - cr109/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    r111:
      kind: linux
      image: frr-854-dev
      binds:
        - r111/daemons:/etc/frr/daemons
        - r111/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r112:
      kind: linux
      image: frr-854-dev
      binds:
        - r112/daemons:/etc/frr/daemons
        - r112/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r121:
      kind: linux
      image: frr-854-dev
      binds:
        - r121/daemons:/etc/frr/daemons
        - r121/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
#        - r121/vtysh.conf:/etc/frr/vtysh.conf
    r122:
      kind: linux
      image: frr-854-dev
      binds:
        - r122/daemons:/etc/frr/daemons
        - r122/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r131:
      kind: linux
      image: frr-854-dev
      binds:
        - r131/daemons:/etc/frr/daemons
        - r131/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r191:
      kind: linux
      image: frr-854-dev
      binds:
        - r191/daemons:/etc/frr/daemons
        - r191/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r192:
      kind: linux
      image: frr-854-dev
      binds:
        - r192/daemons:/etc/frr/daemons
        - r192/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r193:
      kind: linux
      image: frr-854-dev
      binds:
        - r193/daemons:/etc/frr/daemons
        - r193/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r301:
      kind: linux
      image: frr-854-dev
      binds:
        - r301/daemons:/etc/frr/daemons
        - r301/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r302:
      kind: linux
      image: frr-854-dev
      binds:
        - r302/daemons:/etc/frr/daemons
        - r302/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    r391:
      kind: linux
      image: frr-854-dev
      binds:
        - r391/daemons:/etc/frr/daemons
        - r391/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource
    
    r201:
      kind: linux
      image: frr-854-dev
      binds:
        - r201/daemons:/etc/frr/daemons
        - r201/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    r202:
      kind: linux
      image: frr-854-dev
      binds:
        - r202/daemons:/etc/frr/daemons
        - r202/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    r203:
      kind: linux
      image: frr-854-dev
      binds:
        - r203/daemons:/etc/frr/daemons
        - r203/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    r204:
      kind: linux
      image: frr-854-dev
      binds:
        - r204/daemons:/etc/frr/daemons
        - r204/frr.conf:/etc/frr/frr.conf
        - ../src:/app/src
        - ../local:/app/local
        - ../protobufSource:/app/protobufSource

    sw101:
      kind: bridge
    sw111:
      kind: bridge

    pc101:
      kind: linux
      image: praqma/network-multitool:latest

    pc102:
      kind: linux
      image: praqma/network-multitool:latest

    cpc104:
      kind: linux
      image: praqma/network-multitool:latest

    cpc105:
      kind: linux
      image: praqma/network-multitool:latest

    cpc106:
      kind: linux
      image: praqma/network-multitool:latest

    cpc107:
      kind: linux
      image: praqma/network-multitool:latest

    cpc108:
      kind: linux
      image: praqma/network-multitool:latest

    cpc109:
      kind: linux
      image: praqma/network-multitool:latest

    pc111:
      kind: linux
      image: praqma/network-multitool:latest

    pc112:
      kind: linux
      image: praqma/network-multitool:latest

    pc121:
      kind: linux
      image: praqma/network-multitool:latest

    pc131:
      kind: linux
      image: praqma/network-multitool:latest

    pc191:
      kind: linux
      image: praqma/network-multitool:latest

    pc192:
      kind: linux
      image: praqma/network-multitool:latest

    pc193:
      kind: linux
      image: praqma/network-multitool:latest

    pc201:
      kind: linux
      image: praqma/network-multitool:latest

    pc203:
      kind: linux
      image: praqma/network-multitool:latest

    pc204:
      kind: linux
      image: praqma/network-multitool:latest

    pc301:
      kind: linux
      image: praqma/network-multitool:latest

    pc392:
      kind: linux
      image: praqma/network-multitool:latest

    pc393:
      kind: linux
      image: praqma/network-multitool:latest

    pc394:
      kind: linux
      image: praqma/network-multitool:latest

  links:
    - endpoints: ["r101:eth1", "r201:eth1"]
    - endpoints: ["r101:eth2", "sw101:eth1"]
    - endpoints: ["r102:eth1", "sw101:eth2"]
    - endpoints: ["pc102:eth1", "sw101:eth3"]
    - endpoints: ["r101:eth3", "r103:eth1"]
    - endpoints: ["r101:eth4", "pc101:eth1"]
    - endpoints: ["r101:eth5", "r191:eth1"]
    - endpoints: ["r101:eth6", "cr104:eth1"]
    - endpoints: ["r101:eth7", "cr105:eth1"]
    - endpoints: ["r101:eth8", "cr106:eth1"]
    - endpoints: ["r101:eth9", "cr107:eth1"]
    - endpoints: ["r101:eth10", "cr108:eth1"]
    - endpoints: ["r101:eth11", "cr109:eth1"]
    - endpoints: ["r102:eth2", "r103:eth2"]
    - endpoints: ["r102:eth3", "r111:eth1"]
    - endpoints: ["r102:eth4", "r193:eth1"]
    - endpoints: ["cr104:eth2", "cpc104:eth1"]
    - endpoints: ["cr105:eth2", "cpc105:eth1"]
    - endpoints: ["cr106:eth2", "cpc106:eth1"]
    - endpoints: ["cr107:eth2", "cpc107:eth1"]
    - endpoints: ["cr108:eth2", "cpc108:eth1"]
    - endpoints: ["cr109:eth2", "cpc109:eth1"]
    - endpoints: ["r111:eth2", "pc111:eth1"]
    # even though itâ€™s a different switch, you must use other interfaces than on sw101.
    - endpoints: ["r111:eth3", "sw111:eth11"]
    - endpoints: ["r112:eth1", "sw111:eth12"]
    - endpoints: ["pc112:eth1", "sw111:eth13"]
    - endpoints: ["r112:eth2", "r301:eth1"]
    - endpoints: ["r112:eth3", "r192:eth1"]
    - endpoints: ["r103:eth3", "r121:eth1"]
    - endpoints: ["r121:eth3", "pc121:eth1"]
    - endpoints: ["r121:eth2", "r122:eth1"]
    - endpoints: ["r122:eth2", "r131:eth1"]
    - endpoints: ["r131:eth2", "pc131:eth1"]
    - endpoints: ["r191:eth2", "pc191:eth1"]
    - endpoints: ["r192:eth2", "pc192:eth1"]
    - endpoints: ["r193:eth2", "pc193:eth1"]
    # AS65002
    - endpoints: ["r201:eth2", "r202:eth1"]
    - endpoints: ["r201:eth3", "r203:eth1"]
    - endpoints: ["r201:eth4", "r204:eth1"]
    - endpoints: ["r202:eth2", "pc201:eth1"]
    - endpoints: ["r203:eth2", "pc203:eth1"]
    - endpoints: ["r204:eth2", "pc204:eth1"]
    # AS65003
    - endpoints: ["r301:eth2", "r302:eth1"]
    - endpoints: ["r301:eth3", "r391:eth1"]
    - endpoints: ["r301:eth4", "pc392:eth1"]
    - endpoints: ["r302:eth2", "pc301:eth1"]
    - endpoints: ["r391:eth2", "pc393:eth1"]
    - endpoints: ["r391:eth3", "pc394:eth1"]
